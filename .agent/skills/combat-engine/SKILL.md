---
name: combat-engine
description: 武侠文字游戏的战斗叙事约束器。定义等级境界体系、胜负倾向判定以及基于感悟六系的战斗文风生成规则。
---

# 战斗引擎 (Combat Engine)

## 概述
本技能是**叙事约束器**而非传统 ECS 回合制引擎。它为战斗场景提供**规则一致性**与**文风守护**，确保每次战斗描写遵循统一的逻辑框架。

---

## 1. 等级与境界体系 (Level & Realm)

游戏最高等级为 **100 级**，每 **10 级** 为一个境界。境界决定角色的战力层次与叙事基调。

| 境界 | 等级范围 | 江湖地位 | 叙事特征 |
|------|----------|----------|----------|
| **初窥门径** | 1-10 | 江湖新丁 | 招式生涩，内力薄弱，勉强可与山贼过招 |
| **驾轻就熟** | 11-20 | 普通侠客 | 招式初成，已可行走江湖，独闯小寨 |
| **略有小成** | 21-30 | 门派弟子 | 招式流畅，可执行门派普通任务 |
| **融会贯通** | 31-40 | 门派精英 | 内外兼修，开始领悟武学精髓 |
| **炉火纯青** | 41-50 | 一流高手 | 招式精妙，可与门派长老论剑 |
| **所向披靡** | 51-60 | 绝顶高手 | 内力浑厚，名震一方，少有敌手 |
| **天人合一** | 61-70 | 宗师之姿 | 人招合一，武学大成，可自创招式 |
| **登峰造极** | 71-80 | 一代宗师 | 开宗立派之能，名动江湖 |
| **返璞归真** | 81-90 | 人间传说 | 大巧若拙，举手投足皆是绝招 |
| **武林至尊** | 91-100 | 武道神话 | 独孤求败之境，天下无敌 |

### 境界叙事规则
- **境界压制**：高出 2 个境界以上，战斗描写应体现**碾压感**（"如大人戏弄稚子"）。
- **境界接近**：同境界或差 1 境界，战斗描写应体现**势均力敌**的紧张感。
- **越级挑战**：低境界挑战高境界时，需强调**苦战、奇招、侥幸**。

---

## 2. 胜负倾向判定 (Outcome Tendency)

战斗不使用具体数值计算，而是基于以下因素判定**叙事倾向**：

| 因素 | 权重 | 说明 |
|------|------|------|
| **境界差距** | 高 | 决定基础胜负走向 |
| **武学等级** | 中 | 所用招式的精通程度 |
| **地形/时机** | 低 | 背击、埋伏、天气等环境因素 |
| **剧情需要** | 特殊 | 关键剧情节点可适度调整 |

> [!NOTE]
> 胜负倾向仅作为叙事参考，最终结果可根据剧情张力适当调整，但需保持逻辑自洽。

---

## 3. 感悟六系战斗文风 (Insight-Based Combat Style)

战斗描写必须体现主角的**感悟流派**特色（参见 `insight-skill`）：

| 感悟 | 核心机制 | 文风特征 |
|------|----------|----------|
| **动** | 连击/追击 | "招式如狂风骤雨"、"不待敌人喘息便再度出手" |
| **静** | 反击/后发制人 | "以静待动"、"敌招落空之际顺势反击" |
| **刚** | 暴击/破防 | "势如千钧"、"一击之下气浪四溢" |
| **柔** | 卸力/借力打力 | "四两拨千斤"、"将敌劲悄然化解" |
| **巧** | 侧击/背击 | "身影闪烁"、"虚晃一招，剑锋已至咽喉" |
| **拙** | 硬扛/意志 | "以伤换伤"、"任凭敌招落在身上岿然不动" |

---

## 4. 战斗叙事流程

当 `story-engine` 触发战斗场景时，按以下步骤生成描写：

1. **读取角色境界**：从 `character_sheet.md` 获取主角等级与境界。
2. **读取 NPC 战力**：从 `npc_list.md` 获取对手等级与境界。
3. **判定胜负倾向**：根据境界差距确定叙事走向。
4. **匹配感悟文风**：根据主角主修感悟选择战斗描写风格。
5. **输出动态叙事**：生成一段符合上述约束的武侠动作描写。

---

## 5. 战斗状态标签 (Literary Tags)

用文学性标签代替具体数值：

| 类别 | 标签示例 |
|------|----------|
| **精力** | 游刃有余 → 略显疲态 → 气喘吁吁 → 强弩之末 |
| **内力** | 内力充沛 → 真气紊乱 → 经脉受创 → 命悬一线 |
| **伤势** | 毫发无伤 → 皮肉之争 → 血染衣襟 → 重伤垂危 |

---

## 资源参考
- [感悟系统详解](../insight-skill/SKILL.md)
- [主角属性表](../protagonist-skill/references/character_sheet.md)
- [NPC 数据库](../npc-skill/references/npc_list.md)
